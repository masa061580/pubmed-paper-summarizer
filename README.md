# Pubmed論文自動要約アプリ

このGAS（Google Apps Script）アプリケーションは、Pubmedの論文を定期的に検索し、新着論文のアブストラクトをClaudeのAPIで要約して、結果をスプレッドシートに記録し、メールで通知する機能を提供します。

## 機能

- PubmedのAPIを使用して特定の検索用語（ユーザーが指定）で週に1回検索
- 過去1週間にpublishされた論文のAbstractをClaudeのAPIを使って簡潔に要約
- 論文のPubmedID、タイトル、第一著者、Abstractの要約をスプレッドシートに記録
- 同様の内容をユーザーのメールアドレスに送信（PubmedIDはクリック可能なリンク付き）
- 検索用語の組み合わせを複数設定可能、後から編集も可能
- すでにスプレッドシートに記録されたPubmedIDの論文は、再度検索に引っかかっても対象としない
- ブラウザ上で各種設定が可能

## セットアップ手順

### 1. スプレッドシートの作成

1. Googleドライブで新しいスプレッドシートを作成します
2. 適当な名前（例: "Pubmed論文自動要約"）を付けて保存します

### 2. GASプロジェクトの設定

1. スプレッドシートのメニューから「拡張機能」→「Apps Script」を選択
2. Apps Scriptエディタが開いたら、`Code.gs`ファイルをこのリポジトリの`src/Code.gs`の内容で置き換えます
3. 「ファイル」→「新規作成」→「HTMLファイル」を選択し、ファイル名を`index`として作成。内容をこのリポジトリの`src/index.html`で置き換えます
4. 「保存」ボタンをクリックしてプロジェクトを保存します

### 3. Webアプリとしてデプロイ

1. 「デプロイ」→「新しいデプロイ」をクリック
2. 「種類の選択」ドロップダウンから「ウェブアプリ」を選択
3. 「次のユーザーとして実行」は「自分」を選択
4. 「アクセスできるユーザー」は使用状況に応じて選択
   - 「自分のみ」: 自分だけが使用する場合
   - 「リンクを知っている全員」: 他のユーザーと共有する場合
5. 「デプロイ」ボタンをクリック
6. 「アクセス権限の承認」ダイアログが表示されたら、Googleアカウントで承認します
7. デプロイ完了後に表示されるURLをコピーしておきます

### 4. アプリケーションの初期設定

1. コピーしたURLにアクセスしてWebアプリを開きます
2. 「API設定」タブでClaude APIキーを設定します
   - APIキーは [Anthropic Console](https://console.anthropic.com/) から取得できます
3. 「メール設定」タブで通知を受け取るメールアドレスを設定します
4. 「検索設定」タブで検索したい用語と各検索の最大取得件数を設定します
   - 例: "cancer AND immunotherapy", 最大10件
5. 「スケジュール」タブで自動検索を実行する曜日と時間を設定します

## 使い方

### 検索結果の保存と確認

検索された論文情報は以下の2つの方法で確認できます：

1. **スプレッドシート**：
   - すべての検索結果はスプレッドシートの「Results」タブに保存されます
   - 以下の情報が記録されます：
     * PubmedID
     * 論文タイトル
     * 第一著者
     * 出版日
     * 検索用語
     * アブストラクト原文
     * Claudeによる要約
     * 検索日時
   - このシートは検索履歴の参照やデータの分析に使用できます

2. **メール通知**：
   - 新規に検出された論文はメールでも通知されます
   - メールにはPubmedページへのリンクが含まれます

### 検索用語の管理

「検索設定」タブで以下の操作が可能です：

- **検索用語の追加**: 新しい検索用語と最大取得件数を入力して「追加」ボタンをクリック
- **検索用語の編集**: 既存の検索用語や最大取得件数を直接編集すると自動的に保存されます
- **検索用語の削除**: 削除ボタンをクリックして不要な検索用語を削除

### 手動検索実行

「今すぐ検索実行」ボタンをクリックすると、設定した全ての検索用語で即時検索を実行します。検索結果はスプレッドシートに記録され、**新規の論文のみ**がメールで通知されます。

### スケジュール設定

「スケジュール」タブで自動実行のスケジュールを設定できます：

1. 曜日と時間を選択
2. 「スケジュール設定」ボタンをクリック
3. 現在の設定が表示されます

スケジュールを解除するには「スケジュール解除」ボタンをクリックします。

## 注意事項

- Claude APIの利用には料金が発生する場合があります。Anthropicの料金ポリシーを確認してください。
- Pubmed APIには利用制限があります。短時間に多数のリクエストを送信すると制限される可能性があります。
- GASの実行時間には制限（6分）があります。多数の論文を処理する場合は最大取得件数を適切に設定してください。
- 論文のPubmedIDはスプレッドシートで重複チェックに使用されるため、「Results」シートからIDを削除すると、その論文が再度検索対象になる可能性があります。

## トラブルシューティング

### 検索結果が取得できない

- Pubmed APIの接続を確認してください
- 検索用語が正しく設定されているか確認してください
- 過去1週間に該当する新着論文がない可能性があります

### メールが送信されない

- メールアドレスが正しく設定されているか確認してください
- GASのメール送信権限が承認されているか確認してください

### 要約が生成されない

- Claude APIキーが正しく設定されているか確認してください
- Claude APIの接続状態を確認してください

### 同じ論文が重複して通知される

- 「Results」シートのPubmedIDを確認してください
- IDが誤って削除されていると、同じ論文が再度検索対象になります

## ライセンス

MIT License
